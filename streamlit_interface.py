import streamlit as st
import pandas as pd
import traceback

st.set_page_config(page_title="AI-—Å–µ—Ä–≤–∏—Å –ø–æ–¥–±–æ—Ä–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è")

st.markdown("## üßë‚Äçüíª AI-—Å–µ—Ä–≤–∏—Å –ø–æ–¥–±–æ—Ä–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è")
st.markdown("""
–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∏ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç—ã ‚Äî —Å–∏—Å—Ç–µ–º–∞ –≤—Å—ë —Å–¥–µ–ª–∞–µ—Ç —Å–∞–º–∞.
""")

try:
    # --- –¢–ó ---
    st.subheader(":bookmark_tabs: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ")
    tz_file = st.file_uploader("–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å –¢–ó (PDF, DOCX)", type=["pdf", "docx"])

    # --- –ü—Ä–∞–π—Å—ã ---
    st.subheader(":bar_chart: –ü—Ä–∞–π—Å—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤")
    price_files = st.file_uploader("–ó–∞–≥—Ä—É–∑–∏—Ç–µ 1 –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∞–π—Å–æ–≤ (Excel)", type=["xlsx"], accept_multiple_files=True)

    # --- –°–∫–∏–¥–∫–∏ ---
    st.subheader(":money_with_wings: –°–∫–∏–¥–∫–∏ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)")
    discount_file = st.file_uploader("–§–∞–π–ª —Å–æ —Å–∫–∏–¥–∫–∞–º–∏ (Excel)", type=["xlsx"])

    # --- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ ---
    if st.button("–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–¥–±–æ—Ä"):
        st.success("–§–∞–π–ª—ã –ø–æ–ª—É—á–µ–Ω—ã! –ò–¥—ë—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞...")

        if tz_file is not None:
            st.write("–§–∞–π–ª –¢–ó:", tz_file.name)
        else:
            st.warning("–§–∞–π–ª –¢–ó –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω")

        if price_files:
            st.write(f"–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–∞–π—Å–æ–≤: {len(price_files)}")
        else:
            st.warning("–ù–µ—Ç –ø—Ä–∞–π—Å–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞")

        if discount_file:
            st.write("–ó–∞–≥—Ä—É–∂–µ–Ω —Ñ–∞–π–ª —Å–æ —Å–∫–∏–¥–∫–∞–º–∏:", discount_file.name)

        # –í–†–ï–ú–ï–ù–ù–û: –∑–∞–≥–ª—É—à–∫–∞ –¥–æ –ø–æ–ª–Ω–æ–π –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
        st.info("–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.")

except Exception as e:
    st.error("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞:")
    st.code(traceback.format_exc())

